<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="approval_request_form_my_edit" model="ir.ui.view">
        <field name="name">approval.request.my.edit</field>
        <field name="model">approval.request</field>
        <field name="inherit_id" ref="approvals.approval_request_view_form" />
        <field name="arch" type="xml">

            <xpath expr="//header" position="inside">

                <button name="action_determine_specifications" string="Determine Specifications"
                    type="object" class="oe_highlight"
                    groups="mhma_inventory.purchasing_directive_group"
                    invisible="request_status not in ['approved'] or aprvl_type != '1'" />

                <button name="action_purchasing_directive" string="Purchasing Directive"
                    type="object" class="oe_highlight"
                    groups="mhma_inventory.purchasing_directive_group"
                    invisible="request_status not in ['approved', 'pending'] or aprvl_type != '0'" />
                <button name="action_service_directive" string="Service Directive" type="object"
                    class="oe_highlight" groups="mhma_inventory.purchasing_directive_group"
                    invisible="request_status not in ['approved', 'pending'] or aprvl_type != '0'" />
                <button name="action_maintenance_directive" string="Maintenance Directive"
                    type="object" class="oe_highlight"
                    groups="mhma_inventory.purchasing_directive_group"
                    invisible="request_status not in ['approved', 'pending'] or aprvl_type != '0'" />
                <button name="action_disbursing_directive" string="Disbursing Directive"
                    type="object" class="oe_highlight"
                    groups="mhma_inventory.disbursing_directive_group"
                    invisible="request_status not in ['approved', 'pending'] or aprvl_type != '0'" />
                <button name="action_purchase_request" string="Purchase Request"
                    type="object" class="oe_highlight"
                    groups="mhma_inventory.purchasing_directive_group"
                    invisible="request_status not in ['approved', 'pending'] or aprvl_type != '0'" />

                <button name="action_purchase_rfq" string="Purchase RFQ" type="object"
                    class="oe_highlight"
                    invisible="request_status != 'approved' or aprvl_type not in ['1', '2', '3']" />
                <button name="action_direct_purchase" string="Direct Purchase" type="object"
                    class="oe_highlight"
                    invisible="request_status != 'approved' or aprvl_type not in ['1', '2', '3', '5', '6']" />
                <button name="action_disburse_commend" string="Disburse Commend" type="object"
                    class="oe_highlight"
                    invisible="request_status != 'approved' or aprvl_type != '4'" />

                <button name="action_add_vendor" string="Add Vendor" type="object"
                    class="oe_highlight" groups="mhma_inventory.add_vendor_approval_group"
                    invisible="request_status != 'approved' or aprvl_type not in ['10'] or len_partner_ids != 0  " />
                <button name="action_add_customer" string="Add Customer" type="object"
                    class="oe_highlight" groups="mhma_inventory.add_customer_approval_group"
                    invisible="request_status != 'approved' or aprvl_type not in ['10'] or len_partner_ids != 0  " />
                <button name="action_add_partner" string="Add Partner" type="object"
                    class="btn-default" groups="stock.group_stock_manager"
                    invisible="request_status != 'approved' or aprvl_type not in ['10'] or len_partner_ids != 0  " />
            </xpath>

            <xpath expr="//button[@name='action_refuse']" position="before">
                <button
                    name="action_reject"
                    string="Reject"
                    type="object"
                    class="btn-default"
                    invisible="request_status in ['approved', 'refused', 'cancel'] or user_status != 'pending'"
                />
            </xpath>

            <button name="action_cancel" position="after">
                <button
                    name="action_cancel"
                    string="Cancel_dev"
                    type="object"
                    groups="mhma_inventory.purchase_dev_group,mhma_inventory.inventory_dev_group"
                    invisible="request_status in ['new', 'cancel']" />
            </button>
            <button name="action_draft" position="after">
                <button
                    name="action_draft"
                    string="Draft_dev"
                    type="object"
                    groups="mhma_inventory.purchase_dev_group,mhma_inventory.inventory_dev_group"
                    invisible="request_status not in ['cancel']" />
            </button>

            <button name="action_refuse" position="attributes">
                <attribute name="invisible">
                    True
                </attribute>
            </button>


            <xpath expr="//field[@name='request_owner_id']" position="before">
                <field
                    name="statement_subject"
                    placeholder="Enter Statement Subject ..."
                    required=" aprvl_type in ['0'] "
                    readonly=" request_status not in ['new'] "
                />
                <field
                    name="statement_subject"
                    placeholder="Enter Statement Subject ..."
                    required=" aprvl_type in ['0'] "
                    groups="mhma_inventory.purchase_dev_group,mhma_inventory.inventory_dev_group,stock.group_stock_user"
                />
            </xpath>

            <field name="category_id" position="after">
                <field name="category_id"
                    groups="mhma_inventory.purchase_dev_group,mhma_inventory.inventory_dev_group" />
            </field>

            <xpath expr="//field[@name='request_owner_id']" position="after">
                <field name="request_owner_id" readonly="0"
                    string="Change Request Owner"
                    groups="mhma_inventory.request_owner_control_group" />
                <field name="request_owner_id" readonly="0"
                    groups="mhma_inventory.purchase_dev_group,mhma_inventory.inventory_dev_group" />
            </xpath>

            <xpath expr="//field[@name='date_confirmed']" position="after">
                <field name="len_partner_ids" invisible="1" />
                <field name="aprvl_type" invisible="1" />
                <field name="len_stock_picking_ids" invisible="1" />
                <field name="dsbrs_id" string="Request Needed"
                    invisible="aprvl_type not in ['0', '1', '3', '4', '5', '6']"
                    options="{'no_create': True, 'no_create_edit':True}" />
                <field name="req_purchase_id" invisible="aprvl_type != '2'" />
            </xpath>
            <xpath expr="/form/sheet/notebook[1]" position="before">
            </xpath>

            <xpath
                expr="//page[@name='approvers']/field[@name='approver_ids']/tree/field[@name='can_edit']"
                position="before">
                <field name="sequence" widget="handle"
                    groups="mhma_inventory.purchase_dev_group,mhma_inventory.inventory_dev_group,mhma_inventory.control_in_approvers_group" />
                <field name="sequence" optional="1" readonly="0"
                    groups="mhma_inventory.purchase_dev_group,mhma_inventory.inventory_dev_group" />
            </xpath>

            <xpath expr="/form/sheet/notebook[1]" position="before">
            </xpath>
            <xpath expr="/form/sheet/notebook[1]" position="after">
                <group>
                    <field name="pending_user_id" />
                    <field name="notes" readonly="1"
                        invisible="aprvl_type not in ['0', '1', '2', '3', '4']" />
                </group>
            </xpath>
            <xpath expr="/form/sheet/notebook[1]/page[1]" position="before">
                <page string="Demand Products" name="demand_products"
                    invisible="aprvl_type not in ['0', '1', '2', '3', '4', '5', '6']">

                    <field name="demand_product_line_ids" readonly=" request_status in ['approved', 'refused', 'cancel'] ">
                        <tree editable="1" delete="1" create="1">
                            <field name="sequence" widget="handle" />
                            <field name="demand_product_id"
                                readonly=" state not in ['new'] "
                            />
                            <field name="desc" readonly=" state not in ['new'] " />
                            <field name="qty" readonly=" state not in ['new'] " />
                            <field name="uom_id" readonly="1" force_save="1" />
                            <field name="estimate_cost" optional="1"
                                readonly=" state not in ['new'] " />
                            <field name="detail" column_invisible="1" />

                            <field name="modified_desc" readonly=" pending_user_id != uid "
                                force_save="1" />
                            <field name="modified_qty" readonly=" pending_user_id != uid "
                                force_save="1" />
                            <field name="modified_estimate_cost" optional="1"
                                readonly=" pending_user_id != uid " force_save="1" />
                            <field name="total" sum="total_sum" optional="1" />
                            <field name="modified_detail" column_invisible="1" />

                            <button name="action_view_tool" type="object" string="View Tool" />

                            <field name="state" optional="1" />
                            <field name="pending_user_id" column_invisible="1" />

                            <field name="create_date" optional="1" />
                            <field name="create_uid" optional="1" />
                            <field name="write_date" optional="1" />
                            <field name="write_uid" optional="1" />


                        </tree>
                    </field>

                </page>
                <page string="Determine Specifications" name="determine_specifications"
                    invisible="aprvl_type != '2'">
                    <field name="determine_specifications"
                        readonly="request_status in ['approved', 'refused'] " />
                </page>
            </xpath>

            <xpath expr="/form/sheet/notebook[1]" position="inside">
                <page string="Other Information" name="other_info"
                    invisible=" aprvl_type not in ['0', '1', '2', '3', '4', '5', '6', '10'] ">
                    <group>
                        <field
                            name="dsbrs_ids" string="Directions"
                            invisible="aprvl_type not in ['0']">
                            <tree delete="0" create="0">
                                <field name="name" />
                                <field name="request_owner_id" />
                                <field name="category_id" />
                                <field name="activity_ids" />
                                <field name="request_status" />
                                <field name="company_id" column_invisible="1" />
                                <field name="dsbrs_id" />
                                <field name="create_date" optional="1" />
                                <field name="create_uid" optional="1" />
                                <field name="write_date" optional="1" />
                                <field name="write_uid" optional="1" />
                            </tree>
                        </field>

                        <field name="stock_picking_ids" readonly="1"
                            invisible="request_status not in  ['approved', 'pending'] or aprvl_type not in ['0']" />
                        <field name="stock_picking_dd_ids" readonly="1"
                            invisible="request_status != 'approved' or aprvl_type not in ['4']" />

                        <field name="purchase_order_dis_ids" readonly="1"
                            invisible="request_status not in  ['approved'] or aprvl_type not in ['2']" />
                        <field name="purchase_order_pr_ids" readonly="1"
                            invisible="request_status != 'approved' or aprvl_type not in ['1', '3']" />
                        <field name="approval_direct_purchase_ids" readonly="1"
                            invisible="request_status != 'approved' or aprvl_type not in ['1', '2', '3']" />
                        <field name="purchase_order_ids" string="Purchase Orders" readonly="1"
                            invisible=" aprvl_type not in ['0'] " />
                        <field name="approval_request_need_ids" readonly="1"
                            invisible=" aprvl_type not in ['0', '1', '2', '3', '5', '6'] " />

                        <field name="req_purchase_ids" invisible=" aprvl_type not in ['1'] " />

                        <field name="partner_ids" string="Contact" readonly="1"
                            invisible=" request_status != 'approved' or aprvl_type not in ['10'] " />

                    </group>
                </page>
            </xpath>

            <xpath expr="/form/sheet/notebook[1]/page[1]" position="before">
                <page name="partner_Info" string="Partner Information"
                    invisible="aprvl_type not in ['10']">
                    <group>
                        <group>
                            <field name="partner_name" readonly=" len_partner_ids != 0 "
                                required=" aprvl_type in ['10'] "
                                invisible=" aprvl_type not in ['10'] " />
                            <field name="partner_address" readonly=" len_partner_ids != 0 "
                                invisible=" aprvl_type not in ['10'] " />
                            <field name="partner_email" readonly=" len_partner_ids != 0 "
                                invisible=" aprvl_type not in ['10'] " />
                        </group>
                        <group>
                            <field name="partner_phone" readonly=" len_partner_ids != 0 "
                                invisible=" aprvl_type not in ['10'] " />
                            <field name="partner_mobile" readonly=" len_partner_ids != 0 "
                                invisible=" aprvl_type not in ['10'] " />
                            <field name="partner_debit_account_id" readonly=" len_partner_ids != 0 "
                                required=" aprvl_type in ['10'] "
                                invisible=" aprvl_type not in ['10'] " />
                            <field name="partner_credit_account_id"
                                readonly=" len_partner_ids != 0 " required=" aprvl_type in ['10'] "
                                invisible=" aprvl_type not in ['10'] " />
                        </group>
                    </group>

                </page>
            </xpath>

            <xpath expr="//field[@name='quantity']" position="before">
                <field name="depart_id" readonly="1" />
                <field name="depart_id" readonly="0"
                    groups="mhma_inventory.purchase_dev_group,mhma_inventory.inventory_dev_group" />
                <field name="currency_id" readonly="request_status not in ['new']"
                    invisible=" aprvl_type not in ['0', '1', '2', '3', '4', '5', '6'] or total_all == 0 " />
                <field name="currency_id"
                    invisible=" aprvl_type not in ['0', '1', '2', '3', '4', '5', '6'] or total_all == 0 "
                    groups="mhma_inventory.purchase_dev_group,purchase.group_purchase_user" />

                <field name="total_all" invisible="total_all == 0" />
                <field name="total_all_txt" invisible="total_all == 0" />


            </xpath>

        </field>
    </record>

    <record id="approval_request_list_my_edit" model="ir.ui.view">
        <field name="name">approval.request.list.my.edit</field>
        <field name="model">approval.request</field>
        <field name="inherit_id" ref="approvals.approval_request_view_tree" />
        <field name="arch" type="xml">
            <xpath expr="//tree/field[@name='category_id']" position="after">
                <field name="stock_picking_ids" optional="1" />
                <field name="stock_picking_dd_ids" optional="1" />
                <field name="dsbrs_ids" string="Directions" optional="1" />

                <field name="purchase_order_ids" string="Purchase Orders" optional="1" />
                <field name="purchase_order_pr_ids" optional="1" />
                <field name="purchase_order_dis_ids" optional="1" />


                <field name="create_date" optional="1" />
                <field name="create_uid" optional="1" />
                <field name="write_date" optional="1" />
                <field name="write_uid" optional="1" />
            </xpath>
        </field>
    </record>

</odoo>