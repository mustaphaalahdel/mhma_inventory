[English](README.md)

# MHMA Inventory (`mhma_inventory`)

موديول مخصص لأودو (Odoo 17) يضيف تحسينات عملية على **المخزون/المستودعات** ويقدم **سير عمل متكامل للموافقات** يبدأ من طلب الاحتياج وينتهي بالتوجيه والتنفيذ، مع تقارير PDF محسّنة وضوابط حوكمة وصلاحيات.

> ملاحظة: هذا موديول مخصص (ليس ضمن OCA رسميًا)، لكن تنسيق التوثيق هنا قريب من أسلوب توثيقات OCA.

## الفهرس
- [نبذة](#نبذة)
- [المميزات الرئيسية](#المميزات-الرئيسية)
  - [تحسينات المخزون](#تحسينات-المخزون)
  - [الموافقات وسير العمل](#الموافقات-وسير-العمل)
  - [تقارير PDF](#تقارير-pdf)
  - [الصلاحيات والحوكمة](#الصلاحيات-والحوكمة)
  - [الترجمة ودعم اللغتين](#الترجمة-ودعم-اللغتين)
- [التثبيت](#التثبيت)
- [الإعدادات](#الإعدادات)
- [طريقة الاستخدام](#طريقة-الاستخدام)
  - [استخدام المخزون](#استخدام-المخزون)
  - [استخدام الموافقات](#استخدام-الموافقات)
- [ملاحظات / قيود](#ملاحظات--قيود)
- [خطة تطوير مستقبلية](#خطة-تطوير-مستقبلية)
- [تتبع الأخطاء](#تتبع-الأخطاء)
- [الشكر والاعتمادات](#الشكر-والاعتمادات)
- [الجهة المشرفة](#الجهة-المشرفة)
- [الرخصة](#الرخصة)

## نبذة
يوفر `mhma_inventory`:
- تحسينات عملية لإدارة المنتجات والحركات المخزنية (بحث متقدم، مساعدات تقييم، أتمتة الدفعات، حقول الأستاذ…).
- سير عمل موافقات منظم يغطي: طلبات الاحتياج، طلبات الشراء، تحديد المواصفات، التوجيه بالشراء/الصرف، التوجيه بالخدمة والتوجيه بالصيانة.
- تقارير PDF مناسبة للتوقيع والمراجعة الداخلية والأرشفة.

## المميزات الرئيسية

### تحسينات المخزون
- **وصف متغير المنتج**
  - إضافة حقل نصي على متغير المنتج لتسجيل تفاصيل إضافية غير موجودة في وصف قالب المنتج.

- **حساب تقييم متغير المنتج (مساعد تقييم)**
  - المعادلة: **تقييم المتغير = تكلفة الشراء × الكمية في اليد**.

- **البحث المتقدم للأصناف**
  - البحث بقيمة واحدة عبر:
    - المرجع الداخلي
    - الاسم
    - اسم العرض
    - الباركود
    - علامات تصنيف قالب المنتج
    - علامات تصنيف إضافية للمنتج

- **نوع صرف المنتج**
  - تصنيف المنتج عند الصرف إلى:
    - منتج سلعي
    - أصل ثابت
    - عهدة شخصية

- **إضافة حقول لبند حركة المخزون**
  - مثل:
    - وحدة المخزون في بند الحركة
    - القسم/الجهة المستفيدة التي استلمت الكمية

- **إنشاء اسم تلقائي للدفعة (LOT)**
  - في حال عدم تحديد اسم الدفعة (أو عدم أهميته) يتم إنشاء الاسم تلقائيًا اعتمادًا على **تاريخ الانتهاء** (اليوم/الشهر/السنة).

- **أستاذ المخزون (عرض شامل للحركة)**
  - معلومات تفصيلية تشمل:
    - الرصيد الافتتاحي (كمية + تكلفة)
    - الوارد (كمية + تكلفة)
    - الصادر (كمية + تكلفة)
    - الرصيد النهائي (كمية + تكلفة)
    - قيمة الخصم
    - التكلفة الفعلية للحركة المخزنية

- **تحسينات الانتقاء المخزني (أمر توريد / أمر صرف)**
  - التكلفة الإجمالية للانتقاء (مجموع تكاليف الحركات)
  - إظهار التكلفة الإجمالية كرقم + **نص عربي**
  - إرسال إشعار للمستلم لتأكيد الاستلام
  - إمكانية المستلم بتأكيد الاستلام
  - ربط أمر الصرف بطلب الاحتياج أو التوجيه بالصرف مع أتمتة القيم الافتراضية
  - إضافة حقول القسم (قطاع / دائرة / مكتب / إدارة)

- **استيراد حركات المخزون للانتقاء من ملف Excel**
  - تحديد الأصناف المراد صرفها عبر **المرجع الداخلي + الكمية** لعدة أصناف ثم استيرادها مرة واحدة.

- **منع المخزون السالب**
  - منع عملية الصرف إذا كانت ستؤدي إلى كمية سالبة في المخزون.

- **تجميد حقل وحدة القياس**
  - إمكانية منع موظفي المخزون من تعديل وحدة القياس (حسب طلب المالية).

- **حقل موضوع البيان**
  - حقل يستخدمه محاسب المخازن عند الصرف أو التوريد لتوثيق موضوع العملية.

### الموافقات وسير العمل
- **إضافة أنواع فئات الموافقات**
  1. طلب احتياج أصناف / طلب صرف مخزني
  2. طلب شراء
  3. تحديد مواصفات أصناف
  4. التوجيه بالشراء
  5. التوجيه بالصرف
  6. التوجيه بالخدمة
  7. التوجيه بالصيانة

- **تحديد صلاحيات الوصول لفئات الموافقات**
  - مثلًا: طلب احتياج أصناف ليس متاحًا لأي موظف إلا حسب الصلاحيات.

- **سير عمل طلب الاحتياج حتى التنفيذ**
  - يقوم الموظف بتعبئة:
    - موضوع البيان (إلزامي)
    - جهة الاتصال
    - الوصف (اختياري)
    - بنود المنتجات (الكمية + الوصف + التفاصيل)
  - ثم يتم اعتماد الطلب عادة عبر:
    - المدراء المباشرين (مراجعة وتعديل حسب احتياج القسم)
    - مدير المالية (مراجعة وتقدير التكلفة واعتماد الميزانية)
    - مدير المشتريات والمخازن (التحقق من توفر المخزون واعتماد/تعديل حسب المتوفر)
    - التوجيه لمحاسب المشتريات والمخازن للصرف
    - إنشاء أمر صرف وتسليمه من أمين المخازن
    - إشعار المستلم لتأكيد الاستلام وتوثيق ذلك

- **طلب شراء / تحديد مواصفات / توجيه بالشراء**
  - إعداد الأصناف والمواصفات والكمية والتكلفة التقديرية من اللجان واعتمادها وفق السلسلة المتبعة.

- **التوجيه بالخدمة والتوجيه بالصيانة**
  - توجيه احتياج خدمة (مثل سداد إنترنت/كهرباء) للجهة المعنية
  - توجيه احتياج صيانة (مثل طابعة/باب) للجهة المعنية

- **منتجات الطلب (كتالوج جاهز للطلب)**
  - إنشاء مودل لتسهيل طلب الأصناف المتكررة (مثل قلم، ورق A4...) يحتوي على:
    - اسم منتج الطلب
    - فئة المنتج
    - وحدة القياس
    - التكلفة التقديرية
    - نوع المنتج
    - الوصف
    - مجموعة الوصول (تحديد من يحق له طلب هذا المنتج)
    - قالب التفاصيل

- **تتبع التعديلات على البنود (Chatter)**
  - أي تعديل على الكمية/الوصف/التكلفة/التفاصيل يتم تسجيله في الـ Chatter.

- **الربط مع المستندات التشغيلية**
  - ربط توجيه الصرف مع أوامر الصرف/الانتقاء لمعرفة ما تم صرفه حسب التوجيه
  - ربط توجيه الشراء مع أوامر الشراء لمعرفة ما تم شراؤه حسب التوجيه

- **طلب إضافة مورد**
  - طلب إضافة مورد يمر عبر مدير المالية، ثم يتم إنشاء المورد في جهات الاتصال
  - يشمل حساب الدائن/المدين مع ربطهما بالشجرة المحاسبية
  - إصلاحات برمجية لتقييد الحقول اللازمة مثل الاسم

- **ترميز وإعادة تسمية الموافقات**
  - ترميز فئات الموافقات (بادئة + تسلسل)
  - إعادة تسمية الموافقة لتضمين مرجع الموافقة + موضوع البيان لسهولة التتبع

- **واجهة الشراء المباشر (النفقات) وربطها بالتوجيه**
  - تصميم واجهات للشراء المباشر (النفقات) للعمليات الأقل من حد معين (مثل **أقل من 30,000 ريال يمني**)
  - ربط التوجيه بالشراء مع عملية النفقات وتأكيد المستلم عبر الإشعارات

- **الإشعارات وتتبع الحالة**
  - إشعار صاحب الطلب بحالة الموافقة/الرفض/الانتظار
  - إشعارات تأكيد الاستلام للمستلم النهائي

### تقارير PDF
تحسينات على تقارير المخزون والموافقات:
- إضافة الأشخاص المعنيين بالموافقة (للتوقيع)
- إظهار موضوع البيان في التقارير
- إخفاء صورة الباركود والاكتفاء بـ **QR Code**
- إخفاء السريال/رقم الدفعة عند الحاجة والاكتفاء بالاسم
- تقارير طلب الاحتياج/التوجيه/طلب الشراء تشمل:
  - مقدم الطلب
  - موضوع البيان
  - تاريخ إرسال الطلب
  - البنود مع الكميات/الأوصاف/التكاليف/التفاصيل بعد التعديل

### الصلاحيات والحوكمة
- إضافة صلاحية **قراءة كاملة** لكل نماذج المخزون فقط (للمراجع/المدقق).
- تقييد الوصول لفئات الموافقات لمنع إنشاء طلبات غير مصرح بها.

### الترجمة ودعم اللغتين
- دعم واجهات النظام باللغتين: **العربية (AR)** و **الإنجليزية (EN)** (حسب ملفات الترجمة المتوفرة).

## التثبيت
1. ضع مجلد `mhma_inventory` ضمن مسار إضافات أودو (addons path).
2. أعد تشغيل خادم أودو.
3. فعّل **وضع المطور**.
4. من **التطبيقات** → **تحديث قائمة التطبيقات**.
5. ابحث عن `mhma_inventory` ثم قم بالتثبيت.

## الإعدادات
- توزيع الأدوار والصلاحيات:
  - مستخدمي المخزون / أمين مخازن
  - محاسب مخازن
  - منشئي/معتمدي الموافقات لكل فئة
  - مراجع/مدقق مخزون (قراءة فقط)
- إعداد مسارات الموافقات والمعتمدين حسب الهيكل التنظيمي.
- إعداد كتالوج منتجات الطلب (اختياري ومفيد لتسهيل الطلبات).

## طريقة الاستخدام

### استخدام المخزون
- استخدم البحث المتقدم في شاشة المنتجات.
- املأ “وصف متغير المنتج” عند الحاجة.
- أنشئ عمليات الصرف/التوريد مع:
  - موضوع البيان
  - حقول القسم
  - التكلفة الإجمالية وتأكيد الاستلام
- استخدم الاستيراد من Excel عند تجهيز صرف جماعي.

### استخدام الموافقات
- أنشئ طلب احتياج/شراء واملأ موضوع البيان وبنود المنتجات.
- أرسل الطلب للموافقة.
- يقوم المعتمدون بمراجعة البنود وتعديلها (والتعديلات تُسجّل في Chatter).
- بعد الاعتماد النهائي يتم إصدار التوجيه وربطه بالمستند التنفيذي (صرف/شراء).
- يصل إشعار للمستلم لتأكيد الاستلام وتوثيقه.

## ملاحظات / قيود
- لا توجد قيود موثقة حاليًا. الرجاء الإبلاغ عبر GitHub.

## خطة تطوير مستقبلية
- تحسين قوالب الاستيراد من Excel والتحقق من البيانات.
- إضافة نماذج وتقارير إضافية عند الحاجة.

## تتبع الأخطاء
يمكن الإبلاغ عن الأخطاء وطلبات التحسين عبر GitHub Issues الخاصة بهذا المستودع.

## الشكر والاعتمادات

### المطور
- مصطفى الأحذل

### المساهمات
- نرحب بالمساهمات عبر Pull Requests.

## الجهة المشرفة
هذا الموديول تحت صيانة وإشراف **مصطفى الأحذل**.

## الرخصة
الرخصة المعتمدة هي الرخصة المحددة داخل ملف `__manifest__.py`.
