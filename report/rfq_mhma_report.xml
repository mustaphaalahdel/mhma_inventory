<odoo>
    <template id="rfq_mhma_report">
        <t t-name="rfq_mhma_report">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="mhma_inventory.external_layout_custom">
                        <t t-set="address" t-value="None" />
                        <div class="page">

                            <h3>Purchase <t t-esc="o.name" /></h3>

                            <div class="row mt8 mb8">
                                <div class="col-6">
                                    <div>
                                        <strong>Supplier:</strong>
                                        <t t-esc="o.supplier_id.name" />
                                    </div>
                                    <div>
                                        <strong>Date Order:</strong>
                                        <t t-esc="o.date_order" />
                                    </div>
                                    <div>
                                        <strong>Date Planned:</strong>
                                        <t t-esc="o.date_planned" />
                                    </div>
                                </div>
                                <div class="col-6">
                                    <t t-if="o.approval_purchase_specifications_id">
                                        <div>
                                            <strong>Approval Purchase Specifications:</strong>
                                            <t t-esc="o.approval_purchase_specifications_id.name" />
                                        </div>
                                    </t>
                                    <t t-if="o.approval_purchase_request_id">
                                        <div>
                                            <strong>Purchase Request Directive:</strong>
                                            <t t-esc="o.approval_purchase_request_id.name" />
                                        </div>
                                    </t>
                                    <t t-if="o.request_ref_id">
                                        <div>
                                            <strong>Request Reference:</strong>
                                            <t t-esc="o.request_ref_id.name" />
                                        </div>
                                    </t>
                                </div>
                            </div>

                            <t t-if="o.order_line">
                                <table class="table table-bordered">
                                    <thead style="display: table-row-group">
                                        <tr>
                                            <th name="th_description">
                                                <strong>Description</strong>
                                            </th>
                                            <th name="th_taxes">
                                                <strong>Taxes</strong>
                                            </th>
                                            <th name="th_quantity" class="text-center">
                                                <strong>Qty</strong>
                                            </th>
                                            <th name="th_price_unit" class="text-center">
                                                <strong>Unit Price</strong>
                                            </th>
                                            <th name="th_subtotal" class="text-center">
                                                <strong>Amount</strong>
                                            </th>
                                            <th name="th_total" class="text-center">
                                                <strong>Total</strong>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-set="current_subtotal" t-value="0" />
                                        <t t-foreach="o.order_line" t-as="line">
                                            <t t-set="current_subtotal"
                                                t-value="current_subtotal + line.price_subtotal" />

                                            <tr
                                                t-att-class="'bg-200 fw-bold o_line_section' if line.display_type == 'line_section' else 'fst-italic o_line_note' if line.display_type == 'line_note' else ''">
                                                <t t-if="not line.display_type">
                                                    <td id="product">
                                                        <span t-field="line.name" />
                                                    </td>
                                                    <td name="td_taxes">
                                                        <span
                                                            t-esc="', '.join(map(lambda x: x.description or x.name, line.taxes_id))" />
                                                    </td>
                                                    <td class="text-center">
                                                        <span t-field="line.product_qty" />
                                                        <span t-field="line.product_uom.name"
                                                            groups="uom.group_uom" />
                                                        <span t-if="line.product_packaging_id"> (<span
                                                                t-field="line.product_packaging_qty"
                                                                t-options='{"widget": "integer"}' /> <span
                                                                t-field="line.product_packaging_id" />
                                                            ) </span>
                                                    </td>
                                                    <td class="text-center">
                                                        <span t-field="line.price_unit" />
                                                    </td>
                                                    <td class="text-center">
                                                        <span t-esc="line.price_subtotal" />
                                                    </td>
                                                    <td class="text-center">
                                                        <span t-esc="line.price_total" />
                                                    </td>
                                                    <!-- <td class="text-end">
                                                        <span t-field="line.price_subtotal"
                                                            t-options='{"widget": "monetary", "display_currency": o.currency_id}' />
                                                    </td> -->
                                                </t>
                                                <t t-if="line.display_type == 'line_section'">
                                                    <td colspan="99" id="section">
                                                        <span t-field="line.name" />
                                                    </td>
                                                    <t t-set="current_section" t-value="line" />
                                                    <t t-set="current_subtotal" t-value="0" />
                                                </t>
                                                <t t-if="line.display_type == 'line_note'">
                                                    <td colspan="99" id="note">
                                                        <span t-field="line.name" />
                                                    </td>
                                                </t>
                                            </tr>
                                            <t
                                                t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">
                                                <tr class="is-subtotal text-center">
                                                    <td colspan="99" id="subtotal">
                                                        <strong class="mr16">Subtotal</strong>
                                                        <span
                                                            t-esc="current_subtotal"
                                                            t-options='{"widget": "monetary", "display_currency": o.currency_id}'
                                                        />
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                    </tbody>
                                </table>

                                <div id="total" class="row justify-content-end">
                                    <div class="col-4">
                                        <table class="table table-bordered">
                                            <t t-set="tax_totals" t-value="o.tax_totals" />
                                            <table t-call="purchase.document_tax_totals" />
                                        </table>
                                    </div>
                                </div>

                                <p t-field="o.notes" class="mt-4" />

                            </t>

                            <t t-if="o.demand_product_line_ids">
                                <div class="mt16">
                                    <h4>Demand Product Lines</h4>
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Product</th>
                                                <th>Description</th>
                                                <th>UoM</th>
                                                <th>Quantity</th>
                                                <th>Cost</th>
                                                <th>Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t
                                                t-foreach="o.demand_product_line_ids.sorted(key=lambda line: (line.sequence), reverse=False)"
                                                t-as="line">
                                                <tr>
                                                    <td>
                                                        <t
                                                            t-esc="line.demand_product_id.display_name" />
                                                    </td>
                                                    <td>
                                                        <t t-esc="line.modified_desc" />
                                                    </td>
                                                    <td>
                                                        <t t-esc="line.uom_id.name" />
                                                    </td>
                                                    <td>
                                                        <t t-esc="line.modified_qty" />
                                                    </td>
                                                    <td>
                                                        <t t-if="line.modified_estimate_cost"
                                                            t-esc="line.modified_estimate_cost" />
                                                    </td>
                                                    <td>
                                                        <t t-if="line.total"
                                                            t-esc="round(line.total, 2)" />
                                                    </td>
                                                </tr>
                                                <t t-if="line.modified_detail">
                                                    <tr style="background-color: #F5F5F5;">
                                                        <td colspan="6">
                                                            <t t-raw="line.modified_detail" />
                                                        </td>
                                                    </tr>
                                                </t>
                                            </t>
                                        </tbody>
                                    </table>
                                    <table class="table table-bordered">
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <strong>Total All Number</strong>
                                                </td>
                                                <td>
                                                    <t t-if="not o.rfq_total_all">
                                                        <p style="color: white;">
                                                            ________________________________</p>
                                                    </t>
                                                    <t t-if="o.rfq_total_all">
                                                        <t t-esc="round(o.rfq_total_all, 2)" />
                                                        <span> </span>
                                                        <t t-esc="o.currency_id.symbol" />
                                                    </t>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <strong>Total All Text</strong>
                                                </td>
                                                <td>
                                                    <t t-if="not o.rfq_total_all">
                                                        <p style="color: white;">
                                                            ________________________________</p>
                                                    </t>
                                                    <t t-if="o.rfq_total_all">
                                                        <t t-esc="o.rfq_total_all_txt" />
                                                    </t>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </t>


                        </div>
                    </t>
                </t>
            </t>
        </t>
    </template>

    <record id="action_rfq_mhma_report" model="ir.actions.report">
        <field name="name">RFQ MHMA Report</field>
        <field name="model">purchase.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">mhma_inventory.rfq_mhma_report</field>
        <field name="report_file">mhma_inventory.rfq_mhma_report</field>
        <field name="print_report_name">'RFQ - %s - %s' % (object.name,
            object.supplier_id.name)</field>
        <field name="binding_model_id" ref="model_purchase_order" />
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="mhma_inventory.portrait_custom_paperformat" />
    </record>

</odoo>